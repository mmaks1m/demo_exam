import psycopg2
from datetime import datetime

def insert_all_data():
    conn = psycopg2.connect(
        dbname="shoe_shop",
        user="postgres", 
        password="admin", 
        host="localhost"
    )
    
    cur = conn.cursor()
    
    print("Очистка базы данных...")
    cur.execute("TRUNCATE TABLE users, pickup_points, products, orders, order_items RESTART IDENTITY CASCADE")
    print("База полностью очищена, sequences сброшены")
    

    print("Добавление пользователей...")
    users = [
        ('Администратор', 'Никифорова Весения Николаевна', '94d5ous@gmail.com', 'uzWC67'),
        ('Администратор', 'Сазонов Руслан Германович', 'uth4iz@mail.com', '2L6KZG'),
        ('Администратор', 'Одинцов Серафим Артёмович', 'yzls62@outlook.com', 'JlFRCZ'),
        ('Менеджер', 'Степанов Михаил Артёмович', '1diph5e@tutanota.com', '8ntwUp'),
        ('Менеджер', 'Ворсин Петр Евгеньевич', 'tjde7c@yahoo.com', 'YOyhfR'),
        ('Менеджер', 'Старикова Елена Павловна', 'wpmrc3do@tutanota.com', 'RSbvHv'),
        ('Авторизированный клиент', 'Михайлюк Анна Вячеславовна', '5d4zbu@tutanota.com', 'rwVDh9'),
        ('Авторизированный клиент', 'Ситдикова Елена Анатольевна', 'ptec8ym@yahoo.com', 'LdNyos'),
        ('Авторизированный клиент', 'Ворсин Петр Евгеньевич', '1qz4kw@mail.com', 'gynQMT'),
        ('Авторизированный клиент', 'Старикова Елена Павловна', '4np6se@mail.com', 'AtnDjr')
    ]
    
    cur.execute("DELETE FROM users")
    user_ids = {}  
    
    for user in users:
        cur.execute("INSERT INTO users (role, full_name, login, password) VALUES (%s, %s, %s, %s) RETURNING id", user)
        user_id = cur.fetchone()[0]
        user_ids[user[1]] = user_id 
        print(f"  Пользователь {user[1]} -> ID: {user_id}")
    
    print(f"Добавлено пользователей: {len(users)}") 
    

    print("\nДобавление пунктов выдачи...")
    pickup_points = [
    '420151, г. Лесной, ул. Вишневая, 32',
    '125061, г. Лесной, ул. Подгорная, 8',
    '630370, г. Лесной, ул. Шоссейная, 24',
    '400562, г. Лесной, ул. Зеленая, 32',
    '614510, г. Лесной, ул. Маяковского, 47',
    '410542, г. Лесной, ул. Светлая, 46',
    '620839, г. Лесной, ул. Цветочная, 8',
    '443890, г. Лесной, ул. Коммунистическая, 1',
    '603379, г. Лесной, ул. Спортивная, 46',
    '603721, г. Лесной, ул. Гоголя, 41',
    '410172, г. Лесной, ул. Северная, 13',
    '614611, г. Лесной, ул. Молодежная, 50',
    '454311, г. Лесной, ул. Новая, 19',
    '660007, г. Лесной, ул. Октябрьская, 19',
    '603036, г. Лесной, ул. Садовая, 4',
    '394060, г. Лесной, ул. Фрунзе, 43',
    '410661, г. Лесной, ул. Школьная, 50',
    '625590, г. Лесной, ул. Коммунистическая, 20',
    '625683, г. Лесной, ул. 8 Марта',
    '450983, г. Лесной, ул. Комсомольская, 26',
    '394782, г. Лесной, ул. Чехова, 3',
    '603002, г. Лесной, ул. Дзержинского, 28',
    '450558, г. Лесной, ул. Набережная, 30',
    '344288, г. Лесной, ул. Чехова, 1',
    '614164, г. Лесной, ул. Степная, 30',
    '394242, г. Лесной, ул. Коммунистическая, 43',
    '660540, г. Лесной, ул. Солнечная, 25',
    '125837, г. Лесной, ул. Шоссейная, 40',
    '125703, г. Лесной, ул. Партизанская, 49',
    '625283, г. Лесной, ул. Победы, 46',
    '614753, г. Лесной, ул. Полевая, 35',
    '426030, г. Лесной, ул. Маяковского, 44',
    '450375, г. Лесной ул. Клубная, 44',
    '625560, г. Лесной, ул. Некрасова, 12',
    '630201, г. Лесной, ул. Комсомольская, 17',
    '190949, г. Лесной, ул. Мичурина, 26'
]
    
    cur.execute("DELETE FROM pickup_points")
    pickup_point_ids = {}  
    
    for i, address in enumerate(pickup_points, 1):
        cur.execute("INSERT INTO pickup_points (address) VALUES (%s) RETURNING id", (address,))
        pickup_id = cur.fetchone()[0]
        pickup_point_ids[i] = pickup_id 
        print(f"  Пункт {i} -> ID: {pickup_id}")
    
    print(f"Добавлено пунктов выдачи: {len(pickup_points)}")
    
    print("\nДобавление товаров...")
    products = [
        ('А112Т4', 'Ботинки', 'шт.', 4990, 'Kari', 'Kari', 'Женская обувь', 3, 6, 'Женские Ботинки демисезонные kari', '1.jpg'),
        ('F635R4', 'Ботинки', 'шт.', 3244, 'Обувь для вас', 'Marco Tozzi', 'Женская обувь', 2, 13, 'Ботинки Marco Tozzi женские демисезонные, размер 39, цвет бежевый', '2.jpg'),
        ('H782T5', 'Туфли', 'шт.', 4499, 'Kari', 'Kari', 'Мужская обувь', 4, 5, 'Туфли kari мужские классика MYZ21AW-450A, размер 43, цвет: черный', '3.jpg'),
        ('G783F5', 'Ботинки', 'шт.', 5900, 'Kari', 'Рос', 'Мужская обувь', 2, 8, 'Мужские ботинки Рос-Обувь кожаные с натуральным мехом', '4.jpg'),
        ('J384T6', 'Ботинки', 'шт.', 3800, 'Обувь для вас', 'Rieker', 'Мужская обувь', 2, 16, 'B3430/14 Полуботинки мужские Rieker', '5.jpg'),
        ('D572U8', 'Кроссовки', 'шт.', 4100, 'Обувь для вас', 'Рос', 'Мужская обувь', 3, 6, '129615-4 Кроссовки мужские', '6.jpg'),
        ('F572H7', 'Туфли', 'шт.', 2700, 'Kari', 'Marco Tozzi', 'Женская обувь', 2, 14, 'Туфли Marco Tozzi женские летние, размер 39, цвет черный', '7.jpg'),
        ('D329H3', 'Полуботинки', 'шт.', 1890, 'Обувь для вас', 'Alessio Nesca', 'Женская обувь', 4, 4, 'Полуботинки Alessio Nesca женские 3-30797-47, размер 37, цвет: бордовый', '8.jpg'),
        ('B320R5', 'Туфли', 'шт.', 4300, 'Kari', 'Rieker', 'Женская обувь', 2, 6, 'Туфли Rieker женские демисезонные, размер 41, цвет коричневый', '9.jpg'),
        ('G432E4', 'Туфли', 'шт.', 2800, 'Kari', 'Kari', 'Женская обувь', 3, 15, 'Туфли kari женские TR-YR-413017, размер 37, цвет: черный', '10.jpg'),
        ('S213E3', 'Полуботинки', 'шт.', 2156, 'Обувь для вас', 'CROSBY', 'Мужская обувь', 3, 6, '407700/01-01 Полуботинки мужские CROSBY', None),
        ('E482R4', 'Полуботинки', 'шт.', 1800, 'Kari', 'Kari', 'Женская обувь', 2, 14, 'Полуботинки kari женские MYZ20S-149, размер 41, цвет: черный', None),
        ('S634B5', 'Кеды', 'шт.', 5500, 'Обувь для вас', 'CROSBY', 'Мужская обувь', 3, 0, 'Кеды Caprice мужские демисезонные, размер 42, цвет черный', None),
        ('K345R4', 'Полуботинки', 'шт.', 2100, 'Обувь для вас', 'CROSBY', 'Мужская обувь', 2, 3, '407700/01-02 Полуботинки мужские CROSBY', None),
        ('O754F4', 'Туфли', 'шт.', 5400, 'Обувь для вас', 'Rieker', 'Женская обувь', 4, 18, 'Туфли женские демисезонные Rieker артикул 55073-68/37', None),
        ('G531F4', 'Ботинки', 'шт.', 6600, 'Kari', 'Kari', 'Женская обувь', 12, 9, 'Ботинки женские зимние ROMER арт. 893167-01 Черный', None),
        ('J542F5', 'Тапочки', 'шт.', 500, 'Kari', 'Kari', 'Мужская обувь', 13, 0, 'Тапочки мужские Арт.70701-55-67син р.41', None),
        ('B431R5', 'Ботинки', 'шт.', 2700, 'Обувь для вас', 'Rieker', 'Мужская обувь', 2, 5, 'Мужские кожаные ботинки/мужские ботинки', None),
        ('P764G4', 'Туфли', 'шт.', 6800, 'Kari', 'CROSBY', 'Женская обувь', 15, 15, 'Туфли женские, ARGO, размер 38', None),
        ('C436G5', 'Ботинки', 'шт.', 10200, 'Kari', 'Alessio Nesca', 'Женская обувь', 15, 9, 'Ботинки женские, ARGO, размер 40', None),
        ('F427R5', 'Ботинки', 'шт.', 11800, 'Обувь для вас', 'Rieker', 'Женская обувь', 15, 11, 'Ботинки на молнии с декоративной пряжкой FRAU', None),
        ('N457T5', 'Полуботинки', 'шт.', 4600, 'Kari', 'CROSBY', 'Женская обувь', 3, 13, 'Полуботинки Ботинки черные зимние, мех', None),
        ('D364R4', 'Туфли', 'шт.', 12400, 'Kari', 'Kari', 'Женская обувь', 16, 5, 'Туфли Luiza Belly женские Kate-lazo черные из натуральной замши', None),
        ('S326R5', 'Тапочки', 'шт.', 9900, 'Обувь для вас', 'CROSBY', 'Мужская обувь', 17, 15, 'Мужские кожаные тапочки "Профиль С.Дали"', None),
        ('L754R4', 'Полуботинки', 'шт.', 1700, 'Kari', 'Kari', 'Женская обувь', 2, 7, 'Полуботинки kari женские WB2020SS-26, размер 38, цвет: черный', None),
        ('M542T5', 'Кроссовки', 'шт.', 2800, 'Обувь для вас', 'Rieker', 'Мужская обувь', 18, 3, 'Кроссовки мужские TOFA', None),
        ('D268G5', 'Туфли', 'шт.', 4399, 'Обувь для вас', 'Rieker', 'Женская обувь', 3, 12, 'Туфли Rieker женские демисезонные, размер 36, цвет коричневый', None),
        ('T324F5', 'Сапоги', 'шт.', 4699, 'Kari', 'CROSBY', 'Женская обувь', 2, 5, 'Сапоги замша Цвет: синий', None),
        ('K358H6', 'Тапочки', 'шт.', 599, 'Kari', 'Rieker', 'Мужская обувь', 20, 2, 'Тапочки мужские син р.41', None),
        ('H535R5', 'Ботинки', 'шт.', 2300, 'Обувь для вас', 'Rieker', 'Женская обувь', 2, 7, 'Женские Ботинки демисезонные', None)
    ]
    
    cur.execute("DELETE FROM products")
    for product in products:
        cur.execute("""
            INSERT INTO products 
            (article, name, unit, price, supplier, manufacturer, category, discount, stock_quantity, description, image_path) 
            VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)
        """, product)
    print(f"Добавлено товаров: {len(products)}")
    
    print("\nДобавление заказов...")
    orders = [
        (1, user_ids['Степанов Михаил Артёмович'], '2025-02-27 00:00:00', '2025-04-20 00:00:00', pickup_point_ids[1], 901, 'Завершен'),
        (2, user_ids['Никифорова Весения Николаевна'], '2022-09-28 00:00:00', '2025-04-21 00:00:00', pickup_point_ids[11], 902, 'Завершен'),
        (3, user_ids['Сазонов Руслан Германович'], '2025-03-21 00:00:00', '2025-04-22 00:00:00', pickup_point_ids[2], 903, 'Завершен'),
        (4, user_ids['Одинцов Серафим Артёмович'], '2025-02-20 00:00:00', '2025-04-23 00:00:00', pickup_point_ids[11], 904, 'Завершен'),
        (5, user_ids['Степанов Михаил Артёмович'], '2025-03-17 00:00:00', '2025-04-24 00:00:00', pickup_point_ids[2], 905, 'Завершен'),
        (6, user_ids['Никифорова Весения Николаевна'], '2025-03-01 00:00:00', '2025-04-25 00:00:00', pickup_point_ids[15], 906, 'Завершен'),
        (7, user_ids['Сазонов Руслан Германович'], '2025-02-28 00:00:00', '2025-04-26 00:00:00', pickup_point_ids[3], 907, 'Завершен'),
        (8, user_ids['Одинцов Серафим Артёмович'], '2025-03-31 00:00:00', '2025-04-27 00:00:00', pickup_point_ids[19], 908, 'Новый'),
        (9, user_ids['Степанов Михаил Артёмович'], '2025-04-02 00:00:00', '2025-04-28 00:00:00', pickup_point_ids[5], 909, 'Новый'),
        (10, user_ids['Степанов Михаил Артёмович'], '2025-04-03 00:00:00', '2025-04-29 00:00:00', pickup_point_ids[19], 910, 'Новый')
    ]
    
    cur.execute("DELETE FROM orders")
    for order in orders:
        cur.execute("""
            INSERT INTO orders 
            (id, user_id, order_date, delivery_date, pickup_point_id, receive_code, status) 
            VALUES (%s, %s, %s, %s, %s, %s, %s)
        """, order)
    print(f"Добавлено заказов: {len(orders)}")
    
    print("\nДобавление элементов заказов...")
    order_items = [
        (1, 'А112Т4', 2),
        (1, 'F635R4', 2),
        (2, 'H782T5', 1),
        (2, 'G783F5', 1),
        (3, 'J384T6', 10),
        (3, 'D572U8', 10),
        (4, 'F572H7', 5),
        (4, 'D329H3', 4),
        (5, 'А112Т4', 2),
        (5, 'F635R4', 2),
        (6, 'H782T5', 1),
        (6, 'G783F5', 1),
        (7, 'J384T6', 10),
        (7, 'D572U8', 10),
        (8, 'F572H7', 5),
        (8, 'D329H3', 4),
        (9, 'B320R5', 5),
        (9, 'G432E4', 1),
        (10, 'S213E3', 5),
        (10, 'E482R4', 5)
    ]
    
    cur.execute("DELETE FROM order_items")
    for item in order_items:
        cur.execute("""
            INSERT INTO order_items 
            (order_id, product_article, quantity) 
            VALUES (%s, %s, %s)
        """, item)
    print(f"Добавлено элементов заказов: {len(order_items)}")
    
    conn.commit()
    
    print("\n" + "="*50)
    print("ИТОГОВАЯ СТАТИСТИКА:")
    print("="*50)
    
    cur.execute("SELECT COUNT(*) FROM users")
    print(f"Пользователей: {cur.fetchone()[0]}")
    
    cur.execute("SELECT COUNT(*) FROM pickup_points")
    print(f"Пунктов выдачи: {cur.fetchone()[0]}")
    
    cur.execute("SELECT COUNT(*) FROM products")
    print(f"Товаров: {cur.fetchone()[0]}")
    
    cur.execute("SELECT COUNT(*) FROM orders")
    print(f"Заказов: {cur.fetchone()[0]}")
    
    cur.execute("SELECT COUNT(*) FROM order_items")
    print(f"Элементов заказов: {cur.fetchone()[0]}")
    
    cur.close()
    conn.close()
    
    print("\nВсе данные успешно добавлены в базу!")

if __name__ == "__main__":
    insert_all_data()